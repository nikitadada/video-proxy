<!DOCTYPE html>
<html>
<head>
    <title>Go WebRTC Proxy</title>
</head>
<body style="background: #1a1a1a; color: white; font-family: sans-serif; text-align: center;">
<h2>WebRTC Stream from Go</h2>
<video id="video" autoplay playsinline controls style="width: 80%; border: 2px solid #333;"></video>

<script>
    const pc = new RTCPeerConnection({
        iceServers: [{ urls: 'stun:stun.l.google.com:19302' }]
    });

    // –ö–∞–∫ —Ç–æ–ª—å–∫–æ –ø–æ–ª—É—á–∞–µ–º —Ç—Ä–µ–∫ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞ ‚Äî —Ü–µ–ø–ª—è–µ–º –µ–≥–æ –≤ <video>
    pc.ontrack = (event) => {
        console.log("üì∫ –ü–æ–ª—É—á–µ–Ω –º–µ–¥–∏–∞-—Ç—Ä–µ–∫");
        document.getElementById('video').srcObject = event.streams[0];
    };

    // –ì–æ–≤–æ—Ä–∏–º, —á—Ç–æ —Ç–æ–ª—å–∫–æ –ø—Ä–∏–Ω–∏–º–∞–µ–º –≤–∏–¥–µ–æ
    pc.addTransceiver('video', { direction: 'recvonly' });

    // –°–æ–∑–¥–∞–µ–º Offer –∏ —à–ª–µ–º –µ–≥–æ –Ω–∞ Go-—Å–µ—Ä–≤–µ—Ä
    pc.createOffer()
        .then(offer => pc.setLocalDescription(offer))
        .then(() => fetch('/webrtc', {
            method: 'POST',
            body: JSON.stringify(pc.localDescription)
        }))
        .then(res => res.json())
        .then(answer => pc.setRemoteDescription(answer))
        .catch(console.error);
</script>
</body>
</html>
